#include <assert.h>

#include "crave_governor.h"

int main(int argc, char** argv) {
    // Lists of the permitted frequencies for the CPU, GPU, and memory
    std::vector<long long> cpu_freq_list{345600,499200,652800,806400,960000,1113600,1267200,1420800}; // Size: 8
    std::vector<long long> gpu_freq_list{114750000,216750000,318750000,420750000,522750000,624750000,726750000,854250000,930750000,1032750000,1122000000,1236750000,1300500000}; // Size: 13
    std::vector<long long> mem_freq_list{40800000,68000000,102000000,204000000,408000000,665600000,800000000,1062400000,1331200000,1600000000,1866000000}; // Size: 11

    // gpu driven governor setting
    governor_settings gpu_cluster = {
        {600000000, {{"cpu", 1400000}, {"mem", 825000000}}},
        {543000000, {{"cpu", 1200000}, {"mem", 728000000}}},
        {480000000, {{"cpu", 1000000}, {"mem", 633000000}}},
        {420000000, {{"cpu", 800000},  {"mem", 543000000}}},
        {350000000, {{"cpu", 600000},  {"mem", 413000000}}},
        {266000000, {{"cpu", 400000},  {"mem", 275000000}}},
        {177000000, {{"cpu", 200000},  {"mem", 165000000}}}
    };
    
    // memory driven governor setting
    governor_settings mem_cluster = {
        {165000000, {{"gpu", 177000000}, {"cpu", 200000}}},
        {206000000, {{"gpu", 177000000}, {"cpu", 400000}}},
        {275000000, {{"gpu", 266000000}, {"cpu", 600000}}},
        {413000000, {{"gpu", 350000000}, {"cpu", 800000}}},
        {543000000, {{"gpu", 420000000}, {"cpu", 1000000}}},
        {633000000, {{"gpu", 480000000}, {"cpu", 1100000}}},
        {728000000, {{"gpu", 543000000}, {"cpu", 1200000}}},
        {825000000, {{"gpu", 600000000}, {"cpu", 1400000}}}
    };

    // cpu driven governor setting
    governor_settings cpu_cluster = {
        {200000,  {{"gpu", 177000000}, {"mem", 165000000}}},
        {300000,  {{"gpu", 177000000}, {"mem", 165000000}}},
        {400000,  {{"gpu", 177000000}, {"mem", 165000000}}},
        {500000,  {{"gpu", 266000000}, {"mem", 275000000}}},
        {600000,  {{"gpu", 266000000}, {"mem", 275000000}}},
        {700000,  {{"gpu", 350000000}, {"mem", 413000000}}},
        {800000,  {{"gpu", 350000000}, {"mem", 413000000}}},
        {900000,  {{"gpu", 420000000}, {"mem", 543000000}}},
        {1000000, {{"gpu", 420000000}, {"mem", 543000000}}},
        {1100000, {{"gpu", 480000000}, {"mem", 633000000}}},
        {1200000, {{"gpu", 480000000}, {"mem", 633000000}}},
        {1300000, {{"gpu", 600000000}, {"mem", 825000000}}},
        {1400000, {{"gpu", 600000000}, {"mem", 825000000}}}
    };

    // What is this???
    governor_settings cpu_nu05_cluster0 = {
        {200000,  {{"gpu", 600000000}, {"mem", 543000000}}},
        {300000,  {{"gpu", 350000000}, {"mem", 633000000}}},
        {400000,  {{"gpu", 177000000}, {"mem", 825000000}}},
        {500000,  {{"gpu", 350000000}, {"mem", 543000000}}},
        {600000,  {{"gpu", 543000000}, {"mem", 543000000}}},
        {700000,  {{"gpu", 350000000}, {"mem", 633000000}}},
        {800000,  {{"gpu", 350000000}, {"mem", 543000000}}},
        {900000,  {{"gpu", 177000000}, {"mem", 543000000}}},
        {1000000, {{"gpu", 420000000}, {"mem", 275000000}}},
        {1100000, {{"gpu", 480000000}, {"mem", 275000000}}},
        {1200000, {{"gpu", 480000000}, {"mem", 206000000}}},
        {1300000, {{"gpu", 350000000}, {"mem", 206000000}}},
        {1400000, {{"gpu", 177000000}, {"mem", 165000000}}}
    };

    governor_settings mem_cluster0 = {
        {165000000, {{"gpu", 177000000}, {"cpu", 1400000}}},
        {206000000, {{"gpu", 480000000}, {"cpu", 1200000}}},
        {275000000, {{"gpu", 420000000}, {"cpu", 1000000}}},
        {413000000, {{"gpu", 177000000}, {"cpu", 900000}}},
        {543000000, {{"gpu", 543000000}, {"cpu", 700000}}},
        {633000000, {{"gpu", 350000000}, {"cpu", 600000}}},
        {728000000, {{"gpu", 350000000}, {"cpu", 500000}}},
        {825000000, {{"gpu", 177000000}, {"cpu", 400000}}}
    };

    governor_settings cpu_nu05_cluster1 = {
        {200000,  {{"gpu", 480000000}, {"mem", 543000000}}},
        {300000,  {{"gpu", 480000000}, {"mem", 633000000}}},
        {400000,  {{"gpu", 177000000}, {"mem", 825000000}}},
        {500000,  {{"gpu", 350000000}, {"mem", 543000000}}},
        {600000,  {{"gpu", 350000000}, {"mem", 543000000}}},
        {700000,  {{"gpu", 350000000}, {"mem", 633000000}}},
        {800000,  {{"gpu", 350000000}, {"mem", 543000000}}},
        {900000,  {{"gpu", 177000000}, {"mem", 633000000}}},
        {1000000, {{"gpu", 420000000}, {"mem", 728000000}}},
        {1100000, {{"gpu", 350000000}, {"mem", 633000000}}},
        {1200000, {{"gpu", 350000000}, {"mem", 825000000}}},
        {1300000, {{"gpu", 350000000}, {"mem", 728000000}}},
        {1400000, {{"gpu", 177000000}, {"mem", 633000000}}}
    };

    // Seems right
    CRAVEGovernor run_governor(0, 0, 200, cpu_cluster,mem_cluster,gpu_cluster);
    run_governor.Schedule();

    return 0;
}